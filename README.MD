

## 5) Arquitectura y decisiones t√©cnicas

### 5.1 Diagrama general
El sistema se compone de dos capas principales:


- **Frontend (React + Vite):**
  - SPA que consume la API mediante `fetch` o `axios`.
  - Manejo de estado con hooks (`useState`, `useEffect`).
  - Componente principal: listado y creaci√≥n de productos.
  - Configuraci√≥n de CORS mediante variable `VITE_API_URL`.

- **Backend (FastAPI):**
  - Exposici√≥n de endpoints REST para **Productos** y **Categor√≠as**.
  - Validaciones con **Pydantic** (unicidad, precios y cantidades > 0).
  - Manejo de errores con respuestas controladas (422, 404, 409).
  - Persistencia en base de datos relacional (SQLite para desarrollo, PostgreSQL para producci√≥n).

- **CORS:**
  - Habilitado en FastAPI para aceptar solicitudes desde `http://localhost:5173` (Vite).

---

### 5.2 Librer√≠as clave

#### Backend
- **FastAPI** ‚Üí framework para definir endpoints REST.
- **Pydantic** ‚Üí validaci√≥n de datos (reglas de negocio).
- **SQLAlchemy** ‚Üí ORM para mapear entidades (Producto, Categor√≠a).
- **Uvicorn** ‚Üí servidor ASGI para correr la API.
- **pytest + httpx** ‚Üí pruebas autom√°ticas de endpoints.

#### Frontend
- **React + Vite** ‚Üí desarrollo r√°pido de SPA.
- **axios** ‚Üí consumo de la API (m√°s c√≥modo que `fetch`).
- **React Router (opcional)** ‚Üí navegaci√≥n entre vistas.
- **TailwindCSS (opcional)** ‚Üí estilos r√°pidos y consistentes.

---

### 5.3 Estrategia de estado en frontend
- **Estado local con hooks** (`useState`, `useEffect`).
- No se requiere Redux ni librer√≠as externas dado el alcance del MVP.
- Ejemplo:
  - `productos` ‚Üí lista obtenida desde el backend.
  - `loading` y `error` ‚Üí control de estados al hacer fetch.

---

### 5.4 Manejo de errores
- **422 Unprocessable Entity** ‚Üí datos inv√°lidos (precio < 1, cantidad < 1).
- **404 Not Found** ‚Üí recurso inexistente (producto o categor√≠a no encontrada).
- **409 Conflict** ‚Üí duplicados (nombre de producto o categor√≠a ya existente).
- **200/201/204** ‚Üí operaciones exitosas (lectura, creaci√≥n, eliminaci√≥n).

Frontend:
- Mostrar mensajes claros al usuario (ej. ‚ÄúEl producto ya existe‚Äù o ‚ÄúCantidad inv√°lida‚Äù).
- Estados de **loading/error** visibles en pantalla.

---

### 5.5 Decisiones t√©cnicas
- **Base de datos**: se usar√° SQLite en desarrollo por simplicidad, pero se puede migrar a PostgreSQL sin cambios mayores gracias a SQLAlchemy.
- **Estructura modular**: separar backend en carpetas (`models/`, `routes/`, `core/`) para mantener orden.
- **Validaciones en backend**: se prioriza la l√≥gica de validaci√≥n en Pydantic para evitar datos inconsistentes en la BD.
- **UI simple pero robusta**: empezar con listado + creaci√≥n (vertical slice) y luego expandir a edici√≥n/eliminaci√≥n.
- **Pruebas m√≠nimas**: se incluir√° al menos 1 prueba automatizada para verificar el CRUD.

---

### DIAGRAMA SPA
+------------------+                           +------------------------------+
|  Usuario         |  HTML/CSS/JS (SPA)        |  React (Vite) - Frontend     |
|  Navegador       +--------------------------> |  http://localhost:5173       |
+------------------+                           |  - Lista/crea productos      |
                                               |  - Estado: loading/error     |
                                               |  - fetch/axios               |
                                               +---------------+--------------+
                                                               |
                                                               | HTTP JSON (CORS)
                                                               v
                                               +---------------+--------------+
                                               |  FastAPI - Backend           |
                                               |  http://127.0.0.1:8000       |
                                               |  Endpoints:                  |
                                               |   - /productos (CRUD)        |
                                               |   - /categorias (CRUD)       |
                                               |  Validaciones Pydantic       |
                                               |  C√≥digos: 200/201/204/404/   |
                                               |           409/422            |
                                               +---------------+--------------+
                                                               |
                                                               | ORM (SQLAlchemy)
                                                               v
                                               +---------------+--------------+
                                               |   Base de datos              |
                                               |   SQLite (dev) / Postgres    |
                                               |   Tablas: Producto, Categoria|
                                               +------------------------------+

## SECUENCIA TIPICA
Usuario
  |
  | (1) Completa formulario "Nuevo producto"
  v
React SPA
  |
  | (2) POST /productos
  |     Body:
  |     { id_categoria, nombre_producto, precio, cantidad, fecha_creacion }
  v
FastAPI
  |
  | (3) Valida Pydantic:
  |     - nombre_producto √∫nico (409 si existe)
  |     - precio >= 1, cantidad >= 1 (422 si falla)
  | (4) INSERT via SQLAlchemy
  v
Base de datos
  |
  | (5) OK (id generado)
  v
FastAPI
  |
  | (6) 201 Created
  |     Location: /productos/{id}
  v
React SPA
  |
  | (7) GET /productos?offset=0&limit=10
  v
FastAPI -> DB -> FastAPI
  |
  | (8) 200 OK
  |     Header: X-Total-Count
  |     Body: [ ... productos ... ]
  v
React SPA (actualiza lista y muestra √©xito)

## PUERTOS Y FLUJO DE RED
[ Navegador ]
     |
     |  Origin: http://localhost:5173
     v
[ React (Vite dev server) ]  --CORS-->  [ FastAPI (uvicorn) ]  -->  [ DB ]
                5173                         8000

## Mini-ERD
+-------------+        1        n +-------------+
|  Categoria  |------------------>|  Producto   |
| id (PK)     |                   | id (PK)     |
| nombre (*)  |                   | id_categoria|
| descripcion |                   | nombre (*)  |
+-------------+                   | precio      |
                                  | cantidad    |
                                  | fecha_crea  |
                                  +-------------+
(*) √∫nicos

## 6) Plan del proyecto

### 6.1 Roadmap

**Semana 6 (Entregable 1 ‚Äî MVP Alpha)**
- ‚úÖ Definici√≥n del caso (inventario de productos).  
- ‚úÖ Modelo de datos inicial (categor√≠as y productos).  
- ‚úÖ API dise√±ada (endpoints CRUD, validaciones).  
- ‚úÖ Arquitectura y decisiones t√©cnicas documentadas.  
- üöß Vertical slice en progreso (CRUD b√°sico).  

**Semana 7‚Äì10**
- Implementar CRUD completo en backend con FastAPI + SQLAlchemy.  
- A√±adir validaciones de negocio (unicidad, rangos, fechas).  
- Configurar CORS y variables de entorno (`VITE_API_URL`).  
- Frontend: listar y crear productos, mostrar loading/error.  
- Prueba automatizada b√°sica con `pytest` + `httpx`.  

**Semana 11 (Entregable 2 ‚Äî MVP completo)**  
- Backend y frontend listos para CRUD b√°sico.  
- Paginaci√≥n (`offset/limit`) en el GET de productos.  
- UI con b√∫squeda por nombre (debounce 300ms) y/o orden asc/desc.  
- Capturas de funcionamiento (UI + API).  

**Semana 12‚Äì15**
- Mejorar estilos de UI (TailwindCSS).  
- Manejo de m√°s validaciones y reglas (ej. no borrar categor√≠as con productos).  
- Tests adicionales (errores 404, 409, 422).  
- Documentaci√≥n ampliada (ejemplos JSON de request/response).  
- Integraci√≥n opcional con PostgreSQL.  

**Semana 16 (Entrega final)**  
- Demo funcional completa: CRUD productos + categor√≠as.  
- Evidencia (capturas + video corto ‚â§3 min).  
- Repositorio final con estructura limpia y documentaci√≥n clara.  
- Checklist final de entregable cumplido.  

---

## 6.2 Kanban En Imagen Subida al repositorio

